<!DOCTYPE html>
<html>
<head>
    <style>
        .form-group, .output-section {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .form-group label, .output-section p {
            margin: 0;
            margin-right: 10px;
            width: 200px;
        }
        .form-group input, .form-group select {
            flex: 1;
        }
        .italic {
            font-style: italic;
        }
        .bold {
            font-weight: bold;
        }
        .hidden {
            display: none;
        }
        h2 {
            margin-top: 20px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <form id="patientForm">
        <div class="form-group">
            <label for="consultationTime">Consultation Date & Time:</label>
            <input type="datetime-local" id="consultationTime" name="consultationTime">
        </div>
        <div class="form-group">
            <label for="counselorName">Name of Genetic Counselor:</label>
            <select id="counselorName" name="counselorName">
                <option value="Hannah N. Green, MS, CGC">Hannah N. Green, MS, CGC</option>
                <option value="Andria G. Besser, MS, CGC">Andria G. Besser, MS, CGC</option>
                <option value="Carissa Huber, MS">Carissa Huber, MS</option>
            </select>
        </div>
        <div class="form-group">
            <label for="doctorName">Name of Doctor:</label>
            <input type="text" id="doctorName" name="doctorName">
        </div>
        <div class="form-group">
            <label for="patientName">Name:</label>
            <input type="text" id="patientName" name="patientName">
        </div>
        <div class="form-group">
            <label for="patientDOB">DOB:</label>
            <input type="date" id="patientDOB" name="patientDOB" onchange="calculateAge()">
        </div>
        <div class="form-group">
            <label for="gameteType">Gamete Type:</label>
            <input type="text" id="gameteType" name="gameteType">
        </div>
        <div class="form-group">
            <label for="partnerName">Partner Name:</label>
            <input type="text" id="partnerName" name="partnerName">
        </div>
        <div class="form-group">
            <label for="partnerDOB">Partner DOB:</label>
            <input type="date" id="partnerDOB" name="partnerDOB" onchange="calculatePartnerAge()">
        </div>
        <div class="form-group">
            <label for="partnerGameteType">Partner Gamete Type:</label>
            <input type="text" id="partnerGameteType" name="partnerGameteType">
        </div>
        <div class="form-group">
            <label for="eggSource">Egg Source:</label>
            <input type="text" id="eggSource" name="eggSource">
        </div>
        <div class="form-group">
            <label for="eggState">State of Egg:</label>
            <select id="eggState" name="eggState">
                <option value="fresh">Fresh</option>
                <option value="frozen">Frozen</option>
            </select>
        </div>
        <div class="form-group">
            <label for="ageOfEgg">Age of Egg:</label>
            <input type="number" id="ageOfEgg" name="ageOfEgg">
        </div>
        <div class="form-group">
            <label for="spermSource">Sperm Source:</label>
            <input type="text" id="spermSource" name="spermSource">
        </div>
        <div class="form-group">
            <label for="gene">Gene:</label>
            <input type="text" id="gene" name="gene">
        </div>
        <div class="form-group">
            <label for="variants">Variant(s):</label>
            <input type="text" id="variants" name="variants">
        </div>
        <div class="form-group">
            <label for="diseaseName">Disease Name:</label>
            <input type="text" id="diseaseName" name="diseaseName">
        </div>
        <div class="form-group">
            <label for="inheritancePattern">Inheritance Pattern:</label>
            <select id="inheritancePattern" name="inheritancePattern" onchange="toggleXLinkedText()">
                <option value="Autosomal Dominant">Autosomal Dominant</option>
                <option value="Autosomal Recessive">Autosomal Recessive</option>
                <option value="X-linked">X-linked</option>
                <option value="Y-linked">Y-linked</option>
                <!-- Add other options if necessary -->
            </select>
        </div>
        <div class="form-group">
            <label for="positiveGameteSource">Positive Gamete Source(s):</label>
            <input type="text" id="positiveGameteSource" name="positiveGameteSource">
        </div>
        <div class="form-group hidden" id="knownFemaleCarrierFeaturesContainer">
            <label for="knownFemaleCarrierFeatures">Known Female Carrier Features:</label>
            <input type="text" id="knownFemaleCarrierFeatures" name="knownFemaleCarrierFeatures">
        </div>
        <button type="button" onclick="submitForm()">Submit</button>
    </form>

    <div id="summaryOutput"></div>

    <script>
        function toggleXLinkedText() {
            var inheritancePattern = document.getElementById('inheritancePattern').value;
            var container = document.getElementById('knownFemaleCarrierFeaturesContainer');
            if (inheritancePattern === 'X-linked') {
                container.classList.remove('hidden');
            } else {
                container.classList.add('hidden');
            }
        }

        function submitForm() {
            var formattedDate = new Date(document.getElementById('consultationTime').value).toLocaleString();
            var counselorName = document.getElementById('counselorName').value;
            var doctorName = document.getElementById('doctorName').value;
            var patientName = document.getElementById('patientName').value;
            var patientDOB = document.getElementById('patientDOB').value;
            var gameteType = document.getElementById('gameteType').value;
            var partnerName = document.getElementById('partnerName').value;
            var partnerDOB = document.getElementById('partnerDOB').value;
            var partnerGameteType = document.getElementById('partnerGameteType').value;
            var eggSource = document.getElementById('eggSource').value;
            var eggState = document.getElementById('eggState').value;
            var ageOfEgg = document.getElementById('ageOfEgg').value || 'Anonymous Donor';
            var spermSource = document.getElementById('spermSource').value;
            var gene = document.getElementById('gene').value;
            var variants = document.getElementById('variants').value;
            var diseaseName = document.getElementById('diseaseName').value;
            var inheritancePattern = document.getElementById('inheritancePattern').value;
            var positiveGameteSource = document.getElementById('positiveGameteSource').value;
            var knownFemaleCarrierFeatures = document.getElementById('knownFemaleCarrierFeatures').value;

            var xLinkedText = inheritancePattern === 'X-linked' ? `
                <ul>
                    <li>For each embryo created with ${eggState} eggs retrieved from a ${ageOfEgg} egg, there is a [chance]% chance that it will be chromosomally normal.</li>
                    <li>For each embryo created from a <span class="italic">${gene}</span> carrier, there is a [chance]% chance that it will be <span class="italic">${gene}</span>-negative.</li>
                    <li>Combined, there is a [chance]% chance that every tested embryo will be both chromosomally normal and <span class="italic">${gene}</span>-negative.</li>
                </ul>
                <p>In other words, each tested embryo has a:</p>
                <ul>
                    <li>25% chance of being a chromosomally normal/<span class="italic">${gene}</span>-negative male</li>
                    <li>25% chance of being a chromosomally normal/<span class="italic">${gene}</span>-negative female</li>
                    <li>25% chance of being a chromosomally normal/<span class="italic">${gene}</span>-positive male: This child is expected to have ${variants}.</li>
                    <li>25% chance of being a chromosomally normal/<span class="italic">${gene}</span>-positive female: Many <span class="italic">${gene}</span>-positive females are asymptomatic due to X-linked inactivation, a natural process where one of the two X chromosomes in each cell is turned off and the other is left on. If the X chromosome with the mutated gene is turned on more than the one with the normal gene, the female might show symptoms of the condition. However, it is unpredictable which females will be symptomatic and to what extent. Most females with X-linked conditions remain asymptomatic.${knownFemaleCarrierFeatures ? ' ' + knownFemaleCarrierFeatures : ''}</li>
                </ul>
                <p>On average, we recommend 2-3 embryos for each desired child.</p>
            ` : '';

            document.getElementById('summaryOutput').innerHTML = `
                <h2>Patient Consult Summary: Genetic Counseling</h2>
                <div class="output-section">
                    <p><strong>Consultation Date & Time:</strong> ${formattedDate}</p>
                    <p><strong>Name of Genetic Counselor:</strong> ${counselorName}</p>
                    <p><strong>Name of Doctor:</strong> ${doctorName}</p>
                    <p><strong>Name:</strong> ${patientName}</p>
                    <p><strong>DOB:</strong> ${patientDOB}</p>
                    <p><strong>Gamete Type:</strong> ${gameteType}</p>
                    <p><strong>Partner Name:</strong> ${partnerName}</p>
                    <p><strong>Partner DOB:</strong> ${partnerDOB}</p>
                    <p><strong>Partner Gamete Type:</strong> ${partnerGameteType}</p>
                    <p><strong>Egg Source:</strong> ${eggSource}</p>
                    <p><strong>State of Egg:</strong> ${eggState}</p>
                    <p><strong>Age of Egg:</strong> ${ageOfEgg}</p>
                    <p><strong>Sperm Source:</strong> ${spermSource}</p>
                    <p><strong>Gene:</strong> <span class="italic">${gene}</span></p>
                    <p><strong>Variant(s):</strong> ${variants}</p>
                    <p><strong>Disease Name:</strong> ${diseaseName}</p>
                    <p><strong>Inheritance Pattern:</strong> ${inheritancePattern}</p>
                    <p><strong>Positive Gamete Source(s):</strong> ${positiveGameteSource}</p>
                </div>
                ${xLinkedText}
            `;
        }

        function calculateAge() {
            var dob = new Date(document.getElementById('patientDOB').value);
            var today = new Date();
            var age = today.getFullYear() - dob.getFullYear();
            var m = today.getMonth() - dob.getMonth();
            if (m < 0 || (m === 0 && today.getDate() < dob.getDate())) {
                age--;
            }
            document.getElementById('ageOfEgg').value = age;
        }

        function calculatePartnerAge() {
            var dob = new Date(document.getElementById('partnerDOB').value);
            var today = new Date();
            var age = today.getFullYear() - dob.getFullYear();
            var m = today.getMonth() - dob.getMonth();
            if (m < 0 || (m === 0 && today.getDate() < dob.getDate())) {
                age--;
            }
            document.getElementById('partnerAge').value = age;
        }
    </script>
</body>
</html>
